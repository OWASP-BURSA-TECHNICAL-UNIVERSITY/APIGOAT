<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API1:2023</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <script src="../js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <h1>API1:2023 - Broken Object Level Authorization</h1>
    <hr>
    <p>
        APIs tend to expose endpoints that handle object identifiers, creating a wide attack surface of Object Level Access Control issues. Object level authorization checks should be considered in every function that accesses a data source using an ID from the user.
    </p>

    <div>
        <h2>LAB Scenario</h2>
        <hr>
        <h5>Context:</h5>
        <p>
            A cloud storage application allows users to upload and manage their files.
            Users are assigned unique IDs.
            Files are also assigned unique IDs.
            There's an API endpoint to download files: GET /files/{fileID}"
        </p>
        <h5>Broken Authorization:</h5>
        <p>
            The API endpoint relies solely on the fileID parameter in the URL.
            It fails to check if the currently logged-in user (through mechanisms like JWT tokens) has permission to access the specific file.
        </p>
        <h5>Attack Scenario:</h5>
        <p>
            Attacker Observation: An attacker, Eve, observes Alice using the cloud storage application. Eve notices the URL pattern for downloading files.
            ID Prediction/Manipulation: Eve might guess or exploit vulnerabilities to obtain other users' IDs (Bob).
            Unauthorized Access: Eve can then construct a URL like GET /files/{bobFileID}. If the Broken Object Level Authorization is present, Eve can download Bob's files without any authorization checks.
        </p>
        <h5>Impact:</h5>
        <p>
            Eve could gain access to confidential documents, personal photos, or other sensitive information stored by Bob in the cloud storage.
        </p>
        <h5>Mitigation:</h5>
        <p>
            The API endpoint should verify the currently logged-in user's ID against the owner ID associated with the requested file before granting access. This ensures only authorized users can download their own files.
        </p> 
    </div>
</body>
</html>