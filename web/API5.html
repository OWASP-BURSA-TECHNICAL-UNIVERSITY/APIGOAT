<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API5:2023</title>
  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
    integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous" />
  <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js"
    integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ"
    crossorigin="anonymous"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js"
    integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY"
    crossorigin="anonymous"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">

  <div class="col-3 px-3 bg-light position-fixed" id="sticky-sidebar">
    <img style="max-width: 100%" src="/logo.png" alt="apigoat"> 
    <nav>
      <a href="/" aria-expanded="false" id="owasp10_2023"
        style="padding: 20% 10% 10 10">
        <i class="fas fa-flag"></i>
        OWASP API TOP 10 2023
      </a>


      <ul class="list-sidebar bg-default" id="OWASP10_2023">
        <li>
          <a href="api1" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API1:<br> Broken Object Level Authorization
          </a>
        </li>
        <li>
          <a href="api2" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API2:<br> Broken Authentication
          </a>
        </li>
        <li>
          <a href="/api3" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API3:<br> Broken Object Property Level Authorization
          </a>
        </li>
        <li>
          <a href="/api4" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API4:<br> Unrestricted Resource Consumption
          </a>
        </li>
        <li>
          <a href="/api5" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API5:<br> Broken Function Level Authorization
          </a>
        </li>
        <li>
          <a href="/api6" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API6:<br> Broken Function Level Authorization
          </a>
        </li>
        <li>
          <a href="/api7" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API7:<br> Server-Side Request Forgery
          </a>
        </li>
        <li>
          <a href="/api8" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API8:<br> Security Misconfiguration
          </a>
        </li>
        <li>
          <a href="/api9" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API9:<br> Improper Inventory Management
          </a>
        </li>
        <li>
          <a href="/api10" class="sidebar-list-items">
            <i class="fas fa-bug"></i>
            API10:<br> Unsafe Consumption of APIs
          </a>

      </ul>
    </nav>
  </div>

      <div class="col offset-3" id="main">
        <h1>API5:2023 - Broken Function Level Authorization</h1>
        <hr>
        <p>
          Complex access control policies with different hierarchies, groups, and roles, and an unclear separation
          between administrative and regular functions, tend to lead to authorization flaws. By exploiting these issues,
          attackers can gain access to other usersâ€™ resources and/or administrative functions.
        </p>

        <div class="container-fluid bg-light">
          <h2>LAB Scenario</h2>

          <div style="float: right;margin: 30px;" class="btn-container">
            <a href="http://localhost:8005" class="btn btn-primary">API 5</a>
          </div>

          <hr>
          <h5>Context:</h5>
          <p>
            A library management system offers an API for various functionalities:

            GET /books: Retrieve a list of all books. (Public function)
            POST /books: Add a new book. (Admin-only function)
            PUT /books/{bookID}: Update an existing book. (Authorized user function)
            DELETE /books/{bookID}: Delete a book. (Admin-only function)
          </p>
          <h5>Broken Authorization:</h5>
          <p>
            The API relies solely on the HTTP method (GET, POST, PUT, DELETE) to determine authorization for specific
            functions.
            It fails to verify the user's role or permissions before performing actions.
          </p>
          <h5>Attack Scenario:</h5>
          <ol>
            <li>Regular User Observation: A regular user, Ben, is familiar with using the API to view the book list (GET
              /books).</li>
            <li>Function Identification: Ben notices a pattern in the API endpoints and suspects there might be
              functionality beyond viewing books.</li>
            <li>Unauthorized Access Attempt: Ben tries modifying the request method to POST /books with book information
              in the request body. If Broken Function Level Authorization exists, Ben might be able to add a new book to
              the library system without any authorization checks.</li>
          </ol>
          <h5>Impact:</h5>
          <p>
            Ben could exploit this vulnerability to add unauthorized or malicious content to the library system's book
            collection. This could disrupt library operations or potentially expose other users to inappropriate
            content. </p>

        </div>
        <div class="container-fluid bg-light">
          <h2>Mitigation</h2>
          <hr>
          <ul>
            <li>
              <p>
                Implement proper authorization checks on each API endpoint. These checks should verify the user's role or permissions before granting access to specific functionalities.
              </p>
            </li>
            <li>
              <p>
                Don't solely rely on HTTP methods for authorization. Utilize mechanisms like access tokens or roles associated with user accounts to restrict unauthorized access to administrative functions like adding or deleting books.
              </p>
            </li>
          </ul>
        </div>

      </div>
    </div>
  </div>
</body>

</html>